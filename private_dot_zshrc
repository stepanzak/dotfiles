# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

export PATH="$PATH:$HOME/.cargo/bin"
# Lines configured by zsh-newuser-install
HISTFILE=~/.histfile
HISTSIZE=1000
SAVEHIST=1000
setopt beep
bindkey -e
# End of lines configured by zsh-newuser-install
export EDITOR=nvim
# The following lines were added by compinstall
zstyle :compinstall filename '/home/blbezcc/.zshrc'

autoload -Uz compinit
compinit
# End of lines added by compinstall
_comp_options+=(globdots) #completion With hidden files I think

#enable native vi mode
bindkey -v
export KEYTIMEOUT=1
#vim cursor
#source ~/zsh/cursor_mode.zsh

#hit v in normal mode to edit command line
autoload -Uz edit-command-line
zle -N edit-command-line
bindkey -M vicmd v edit-command-line

#init thefuck if it exists
[ -x "$(command -v thefuck)" ] && eval $(TF_SHELL=zsh thefuck --alias)

# source antidote (plugin manager)
source ${ZDOTDIR:-~}/.antidote/antidote.zsh

# initialize plugins statically with ${ZDOTDIR:-~}/.zsh_plugins.txt
antidote load

#marlonrichert/zsh-autocomplete config:

#first insert part of string common fir all comoletions (if any)
#example: in foler with index.js and index.html, on Tab, it inserts "index." first. If you add style.css to that foler, it doesn't.
zstyle ':autocomplete:*complete*:*' insert-unambiguous yes
#same thing for searching in completion menu
zstyle ':autocomplete:menu-search:*' insert-unambiguous yes

#Make Tab go straight to the menu and cycle there
bindkey '\t' menu-select "$terminfo[kcbt]" menu-select
bindkey -M menuselect '\t' menu-complete "$terminfo[kcbt]" reverse-menu-complete


#end of zsh-autocomplete config

#bind arrow keys back to normaly. bcs of marlonrichert/zsh-autocomplete
() {
	local -a prefix=( '\e'{\[,O} )
	local -a up=( ${^prefix}A ) down=( ${^prefix}B )
	local key=
	for key in $up[@]; do
		bindkey "$key" up-line-or-history
	done
	for key in $down[@]; do
		bindkey "$key" down-line-or-history
	done
}



#directory stack settings and aliases
setopt AUTO_PUSHD # Push the current directory visited on the stack.
setopt PUSHD_IGNORE_DUPS # Do not store duplicates in the stack.
setopt PUSHD_SILENT # Do not print the directory stack after pushd or popd.
#directory stack aliases - commands 1, 2, 3 etc
alias d='dirs -v'
for index ({1..9}) alias "$index"="cd +${index}"; unset index

#general aliases
alias "bls=exa -a --group-directories-first -s modified --icons"
alias "ls=exa -a --group-directories-first -s name --icons"
alias "sl=sl -eawd3"
alias "rt=trash put"
alias "chz=chezmoi"

#pls = sudo, but with no arguments it's sudo !!
function pls(){
	if [ "$#" -eq 0 ]; then
        	sudo $(fc -ln -1)
	else
		sudo $@
	fi
}

#init nvm (node version manager)
[ -e "/usr/share/nvm/init-nvm.sh" ] && source /usr/share/nvm/init-nvm.sh

#init zoxide (better cd or something) if it exists
[ -x "$(command -v zoxide)" ] && eval "$(zoxide init zsh)"

#source broot (br command) if it exists
[ -e ~/.config/broot/launcher/bash/br ] && source ~/.config/broot/launcher/bash/br

#init atuin (better shell history or something) if it exist
[ -x "$(command -v atuin)" ] && eval "$(atuin init zsh --disable-up-arrow)"

#init trashy (trash CLI but rust) if it exist
#commented out because of zsh completions bug, see issue #57
#[ -x "$(command -v trash)" ] && eval "$(trash completions zsh)"

# To customize prompt, run `p9k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

# pnpm
export PNPM_HOME="/home/stepka/.local/share/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac
# pnpm end
